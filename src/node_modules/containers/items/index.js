import React, {Component} from 'react'
import {connect} from 'react-redux'
import {Link} from 'react-router-dom'
import * as R from 'ramda'

import {fetchItems} from 'actions'
import {getItems} from 'selectors'

/*const Items = () => (
	<div>
		Items
	</div>
);*/

class Items extends Component {
	componentDidMount () {
		this.props.fetchItems()
	}

	renderItem(item, index) {
		const shortDescription = `${R.take(60, item.description)}...`
		return (
			<div className='col-sm-4 col-lg-4 col-md-4 book-list' key={index}>
				<div className='thumbnail'>
					<img 
						className='img-thumbnail' 
						src={item.image} 
						alt={item.name} 
					/>
					<div className = 'caption'>
						<h4 className="pull-right">${item.price}</h4>
						<h4>
							<Link to={`/items/${item.id}`}>
								{item.name}
							</Link>
						</h4> 
						<p>{shortDescription}</p>
						<p className='itemButton'>
							<button className='btn btn-primaty'>
								Buy now!
							</button>
							<Link 
								to={`/items/${item.id}`}
								className='btn btn-default'	
							>
								More info
							</Link>
						</p>
					</div>
				</div>
			</div>
		)
	}

	render () {
		const {items} = this.props
		return(
				<div>
					<div className='books row' >
						{items.map((item, index) => this.renderItem(item, index))}
					</div>
				</div>
			)
	}
}

const mapStateToProps = (state) => {
	return {
	items: getItems(state)
	}
}

const mapDispatchToProps = {
	fetchItems
}

export default connect(mapStateToProps, mapDispatchToProps)(Items);