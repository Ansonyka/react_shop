import {
	FETCH_ITEMS_START,
	FETCH_ITEMS_SUCCESS,
	FETCH_ITEMS_FAILURE,
	LOAD_MORE_ITEMS_START,
	LOAD_MORE_ITEMS_SUCCESS,
	LOAD_MORE_ITEMS_FAILURE,
} from 'actionTypes'

import {getRenderedItemsLength} from 'selectors'

import {
	fetchItems as fetchItemsApi,
	loadMoreItems as loadMoreItemsApi
} from 'api'

export const fetchItems = () => async dispatch => {
	dispatch ({type: FETCH_ITEMS_START})

	try{
		const items = await fetchItemsApi()
		dispatch({
			type: FETCH_ITEMS_SUCCESS,
			payload: items
		})
	} catch (err) {
		dispatch({
			type: FETCH_ITEMS_FAILURE,
			payload: err,
			error: true
		})
	}
	
}

//loadMoreItems

export const loadMoreItems = () => async (dispatch, getState) => {
	const offset = getRenderedItemsLength(getState())
	dispatch ({type: LOAD_MORE_ITEMS_START})

	try{
		const items = await loadMoreItemsApi(offset)
		dispatch({
			type: LOAD_MORE_ITEMS_SUCCESS,
			payload: items
		})
	} catch (err) {
		dispatch({
			type: LOAD_MORE_ITEMS_FAILURE,
			payload: err,
			error: true
		})
	}
	
}
